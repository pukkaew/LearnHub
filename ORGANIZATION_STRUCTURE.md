# üìã ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£‡πÅ‡∏•‡∏∞‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏á‡∏≤‡∏ô (Organization & Position Structure)

## üè¢ 1. Organization Units (‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô)

### ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á: `OrganizationUnits`
```
unit_id (PK)           - ‡∏£‡∏´‡∏±‡∏™‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô
parent_id (FK)         - ‡∏£‡∏´‡∏±‡∏™‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡πÅ‡∏°‡πà (NULL = ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ö‡∏ô‡∏™‡∏∏‡∏î)
level_id (FK)          - ‡∏£‡∏´‡∏±‡∏™‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£ (‚Üí OrganizationLevels)
unit_code              - ‡∏£‡∏´‡∏±‡∏™‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô (‡πÄ‡∏ä‡πà‡∏ô BR001, OFF001)
unit_name_th           - ‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô (‡πÑ‡∏ó‡∏¢)
unit_name_en           - ‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô (‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©)
unit_abbr              - ‡∏ä‡∏∑‡πà‡∏≠‡∏¢‡πà‡∏≠
description            - ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î
manager_id (FK)        - ‡∏£‡∏´‡∏±‡∏™‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ (‚Üí Users)
cost_center            - ‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô
address, phone, email  - ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠
status                 - ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ (ACTIVE/INACTIVE)
is_active              - ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
```

### ‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£ (Hierarchy)
```
‡∏™‡∏≤‡∏Ç‡∏≤ (BRANCH) - level_order: 1
  ‚îî‚îÄ‚îÄ ‡∏™‡∏≥‡∏ô‡∏±‡∏Å (OFFICE) - level_order: 2
      ‚îî‚îÄ‚îÄ ‡∏ù‡πà‡∏≤‡∏¢ (DIVISION) - level_order: 3
          ‚îî‚îÄ‚îÄ ‡πÅ‡∏ú‡∏ô‡∏Å (DEPARTMENT) - level_order: 4
```

### ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
```
‡∏™‡∏≤‡∏Ç‡∏≤‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û (BRANCH)
  ‚îú‚îÄ‚îÄ ‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£ (OFFICE)
  ‚îÇ   ‚îú‚îÄ‚îÄ ‡∏ù‡πà‡∏≤‡∏¢‡∏ó‡∏£‡∏±‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏• (DIVISION)
  ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ‡πÅ‡∏ú‡∏ô‡∏Å‡∏™‡∏£‡∏£‡∏´‡∏≤ (DEPARTMENT)
  ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ‡πÅ‡∏ú‡∏ô‡∏Å‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏ö‡∏∏‡∏Ñ‡∏•‡∏≤‡∏Å‡∏£ (DEPARTMENT)
  ‚îÇ   ‚îî‚îÄ‚îÄ ‡∏ù‡πà‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô (DIVISION)
  ‚îÇ       ‚îú‚îÄ‚îÄ ‡πÅ‡∏ú‡∏ô‡∏Å‡∏ö‡∏±‡∏ç‡∏ä‡∏µ (DEPARTMENT)
  ‚îÇ       ‚îî‚îÄ‚îÄ ‡πÅ‡∏ú‡∏ô‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô (DEPARTMENT)
  ‚îî‚îÄ‚îÄ ‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£ (OFFICE)
      ‚îî‚îÄ‚îÄ ‡∏ù‡πà‡∏≤‡∏¢‡∏ú‡∏•‡∏¥‡∏ï (DIVISION)
          ‚îî‚îÄ‚îÄ ‡πÅ‡∏ú‡∏ô‡∏Å‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û (DEPARTMENT)
```

---

## üëî 2. Positions (‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏á‡∏≤‡∏ô)

### ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á: `Positions`
```
position_id (PK)       - ‡∏£‡∏´‡∏±‡∏™‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á
unit_id (FK)           - ‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î‡πÅ‡∏ú‡∏ô‡∏Å (‚Üí OrganizationUnits ‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô DEPARTMENT ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô!)
position_code          - ‡∏£‡∏´‡∏±‡∏™‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á
position_name_th       - ‡∏ä‡∏∑‡πà‡∏≠‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á (‡πÑ‡∏ó‡∏¢)
position_name_en       - ‡∏ä‡∏∑‡πà‡∏≠‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á (‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©)
position_type          - ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó (EMPLOYEE/APPLICANT)
position_level         - ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á (EXECUTIVE/MANAGER/STAFF/etc.)
job_grade              - ‡πÄ‡∏Å‡∏£‡∏î‡∏á‡∏≤‡∏ô (1-10)
description            - ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏á‡∏≤‡∏ô
responsibilities       - ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö
requirements           - ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥‡∏ú‡∏π‡πâ‡∏™‡∏°‡∏±‡∏Ñ‡∏£
min_salary, max_salary - ‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
status, is_active      - ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
```

### ‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡πÇ‡∏¢‡∏á ‚ö†Ô∏è ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç!
- **1 ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á ‚Üí ‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î 1 ‡πÅ‡∏ú‡∏ô‡∏Å** (unit_id ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô DEPARTMENT)
- **1 ‡πÅ‡∏ú‡∏ô‡∏Å ‚Üí ‡∏°‡∏µ‡πÑ‡∏î‡πâ‡∏´‡∏•‡∏≤‡∏¢‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á**
- **‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î‡∏™‡∏≤‡∏Ç‡∏≤/‡∏™‡∏≥‡∏ô‡∏±‡∏Å/‡∏ù‡πà‡∏≤‡∏¢ ‡πÑ‡∏î‡πâ!**

### ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á
```
‡πÅ‡∏ú‡∏ô‡∏Å‡∏™‡∏£‡∏£‡∏´‡∏≤ (DEPARTMENT - unit_id: 10)
  ‚îú‚îÄ‚îÄ ‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏ú‡∏ô‡∏Å‡∏™‡∏£‡∏£‡∏´‡∏≤ (position_id: 1, unit_id: 10)
  ‚îú‚îÄ‚îÄ ‡∏ô‡∏±‡∏Å‡∏™‡∏£‡∏£‡∏´‡∏≤‡∏≠‡∏≤‡∏ß‡∏∏‡πÇ‡∏™ (position_id: 2, unit_id: 10)
  ‚îî‚îÄ‚îÄ ‡∏ô‡∏±‡∏Å‡∏™‡∏£‡∏£‡∏´‡∏≤ (position_id: 3, unit_id: 10)

‚ö†Ô∏è ‡∏´‡πâ‡∏≤‡∏°‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î:
‚ùå ‡∏™‡∏≤‡∏Ç‡∏≤‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û (BRANCH)
‚ùå ‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£ (OFFICE)
‚ùå ‡∏ù‡πà‡∏≤‡∏¢‡∏ó‡∏£‡∏±‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏• (DIVISION)
‚úÖ ‡πÅ‡∏ú‡∏ô‡∏Å‡∏™‡∏£‡∏£‡∏´‡∏≤ (DEPARTMENT) ‚Üê ‡πÑ‡∏î‡πâ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô!
```

---

## üë• 3. Users/Employees (‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô)

### ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á: `Users`
```
user_id (PK)           - ‡∏£‡∏´‡∏±‡∏™‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ
employee_id            - ‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô (EMP001)
department_id (FK)     - ‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô (‚Üí OrganizationUnits.unit_id)
position_id (FK)       - ‡∏î‡∏≥‡∏£‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á (‚Üí Positions.position_id)
first_name, last_name  - ‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•
email, phone           - ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠
role                   - ‡∏ö‡∏ó‡∏ö‡∏≤‡∏ó‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö (admin/hr/manager/employee)
status, is_active      - ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
```

### ‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡πÇ‡∏¢‡∏á
- **1 ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô ‚Üí ‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î 1 ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô** (department_id)
- **1 ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô ‚Üí ‡∏î‡∏≥‡∏£‡∏á 1 ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á** (position_id)
- **‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ó‡∏µ‡πà‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏î‡∏≥‡∏£‡∏á ‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô**

### ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
```sql
-- ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô "‡∏™‡∏°‡∏ä‡∏≤‡∏¢ ‡πÉ‡∏à‡∏î‡∏µ"
user_id: 100
employee_id: 'EMP100'
department_id: 10          -- ‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î "‡πÅ‡∏ú‡∏ô‡∏Å‡∏™‡∏£‡∏£‡∏´‡∏≤"
position_id: 1             -- ‡∏î‡∏≥‡∏£‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á "‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πà‡∏ß‡∏¢‡πÅ‡∏ú‡∏ô‡∏Å‡∏™‡∏£‡∏£‡∏´‡∏≤"

-- ‡πÇ‡∏î‡∏¢‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á "‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏ú‡∏ô‡∏Å‡∏™‡∏£‡∏£‡∏´‡∏≤" (position_id: 1)
-- ‡∏Å‡πá‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô "‡πÅ‡∏ú‡∏ô‡∏Å‡∏™‡∏£‡∏£‡∏´‡∏≤" (unit_id: 10) ‡πÄ‡∏ä‡πà‡∏ô‡∏Å‡∏±‡∏ô
```

---

## üîÑ 4. ‡∏Å‡∏£‡∏∞‡∏ö‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô (Workflows)

### 4.1 ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà
```
1. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ: ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô
2. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô (cascade):
   - ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏≤‡∏Ç‡∏≤ (BRANCH) ‚Üí ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏≥‡∏ô‡∏±‡∏Å
   - ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏≥‡∏ô‡∏±‡∏Å (OFFICE) ‚Üí ‡πÇ‡∏´‡∏•‡∏î‡∏ù‡πà‡∏≤‡∏¢
   - ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ù‡πà‡∏≤‡∏¢ (DIVISION) ‚Üí ‡πÇ‡∏´‡∏•‡∏î‡πÅ‡∏ú‡∏ô‡∏Å
   - ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏ú‡∏ô‡∏Å (DEPARTMENT) ‚Üê ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
3. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á:
   - API filter ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î‡πÅ‡∏ú‡∏ô‡∏Å‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å (unit_id = ‡πÅ‡∏ú‡∏ô‡∏Å‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å)
4. ‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
```

### 4.2 Cascade Dropdown
```javascript
// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÉ‡∏ô views/users/index.ejs

loadOrganizationUnits()        ‚Üí ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏≤‡∏Ç‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
loadOfficesByBranch(branchId)  ‚Üí ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏†‡∏≤‡∏¢‡πÉ‡∏ï‡πâ‡∏™‡∏≤‡∏Ç‡∏≤
loadDivisionsByOffice(officeId) ‚Üí ‡πÇ‡∏´‡∏•‡∏î‡∏ù‡πà‡∏≤‡∏¢‡∏†‡∏≤‡∏¢‡πÉ‡∏ï‡πâ‡∏™‡∏≥‡∏ô‡∏±‡∏Å
loadDepartmentsByDivision(divId) ‚Üí ‡πÇ‡∏´‡∏•‡∏î‡πÅ‡∏ú‡∏ô‡∏Å‡∏†‡∏≤‡∏¢‡πÉ‡∏ï‡πâ‡∏ù‡πà‡∏≤‡∏¢

// API Endpoint
GET /organization/api/units/{id}/children
‚Üí ‡∏î‡∏∂‡∏á‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏•‡∏π‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Ç‡∏≠‡∏á parent_id ‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏ö‡∏∏
```

### 4.3 Filter ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ï‡∏≤‡∏°‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô
```javascript
// ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏ú‡∏ô‡∏Å‡πÄ‡∏™‡∏£‡πá‡∏à ‡∏à‡∏∞‡πÇ‡∏´‡∏•‡∏î‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î‡πÅ‡∏ú‡∏ô‡∏Å‡∏ô‡∏±‡πâ‡∏ô
GET /organization/positions/api/list?unit_id={department_id}

// ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏ú‡∏ô‡∏Å‡∏™‡∏£‡∏£‡∏´‡∏≤ (unit_id: 10)
// ‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á:
// - ‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏ú‡∏ô‡∏Å‡∏™‡∏£‡∏£‡∏´‡∏≤
// - ‡∏ô‡∏±‡∏Å‡∏™‡∏£‡∏£‡∏´‡∏≤‡∏≠‡∏≤‡∏ß‡∏∏‡πÇ‡∏™
// - ‡∏ô‡∏±‡∏Å‡∏™‡∏£‡∏£‡∏´‡∏≤
```

---

## üìä 5. Queries ‡∏ó‡∏µ‡πà‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç

### 5.1 ‡∏î‡∏∂‡∏á‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£‡πÅ‡∏ö‡∏ö Tree
```sql
WITH UnitTree AS (
    -- Root units (‡πÑ‡∏°‡πà‡∏°‡∏µ parent)
    SELECT unit_id, parent_id, unit_name_th, level_id, 0 as depth
    FROM OrganizationUnits
    WHERE parent_id IS NULL

    UNION ALL

    -- Children units (recursive)
    SELECT ou.unit_id, ou.parent_id, ou.unit_name_th, ou.level_id, ut.depth + 1
    FROM OrganizationUnits ou
    INNER JOIN UnitTree ut ON ou.parent_id = ut.unit_id
)
SELECT * FROM UnitTree ORDER BY depth, unit_name_th
```

### 5.2 ‡∏î‡∏∂‡∏á Breadcrumb Path
```sql
WITH UnitPath AS (
    -- ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏à‡∏≤‡∏Å‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
    SELECT unit_id, parent_id, unit_name_th, 0 as level
    FROM OrganizationUnits
    WHERE unit_id = @unitId

    UNION ALL

    -- ‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ‡∏´‡∏≤ parent
    SELECT ou.unit_id, ou.parent_id, ou.unit_name_th, up.level + 1
    FROM OrganizationUnits ou
    INNER JOIN UnitPath up ON ou.unit_id = up.parent_id
)
SELECT * FROM UnitPath ORDER BY level DESC
-- ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå: ‡∏™‡∏≤‡∏Ç‡∏≤‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û > ‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£ > ‡∏ù‡πà‡∏≤‡∏¢ HR > ‡πÅ‡∏ú‡∏ô‡∏Å‡∏™‡∏£‡∏£‡∏´‡∏≤
```

### 5.3 ‡∏î‡∏∂‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ï‡∏≤‡∏°‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô
```sql
SELECT p.*
FROM Positions p
WHERE p.unit_id = @departmentId
  AND p.is_active = 1
  AND p.position_type = 'EMPLOYEE'
ORDER BY p.position_level, p.position_name_th
```

---

## üéØ 6. Business Rules

### ‡∏Å‡∏é‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç:
1. **Hierarchy Validation**: ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ parent ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô
   - OFFICE ‚Üí parent ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô BRANCH
   - DIVISION ‚Üí parent ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô OFFICE
   - DEPARTMENT ‚Üí parent ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô DIVISION

2. **Position-Unit Matching**: ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Ç‡∏≠‡∏á‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô (position_id) ‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô (department_id)
   ```sql
   -- Validation check
   SELECT 1
   FROM Users u
   JOIN Positions p ON u.position_id = p.position_id
   WHERE u.user_id = @userId
     AND p.unit_id = u.department_id  -- ‡∏ï‡πâ‡∏≠‡∏á match ‡∏Å‡∏±‡∏ô
   ```

3. **Soft Delete**: ‡∏´‡πâ‡∏≤‡∏°‡∏•‡∏ö‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà:
   - ‡∏°‡∏µ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏•‡∏π‡∏Å (children) ‡∏ó‡∏µ‡πà active
   - ‡∏°‡∏µ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà active

4. **Manager Assignment**: ‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô (manager_id) ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏ô‡∏±‡πâ‡∏ô ‡∏´‡∏£‡∏∑‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡πÅ‡∏°‡πà

---

## üìù 7. API Endpoints Summary

### Organization Units
```
GET    /organization                    - ‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£
GET    /organization/api/units          - ‡∏î‡∏∂‡∏á‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
GET    /organization/api/units/:id      - ‡∏î‡∏∂‡∏á‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏ï‡∏≤‡∏° ID
GET    /organization/api/units/:id/children - ‡∏î‡∏∂‡∏á‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏•‡∏π‡∏Å
GET    /organization/api/levels         - ‡∏î‡∏∂‡∏á‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
GET    /organization/api/tree           - ‡∏î‡∏∂‡∏á‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏ö‡∏ö tree
POST   /organization/create             - ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà
PUT    /organization/:id                - ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô
DELETE /organization/:id                - ‡∏•‡∏ö‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô (soft delete)
```

### Positions
```
GET    /organization/positions                      - ‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á
GET    /organization/positions/api/list            - ‡∏î‡∏∂‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
GET    /organization/positions/api/list?unit_id=X  - ‡∏î‡∏∂‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ï‡∏≤‡∏°‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô
POST   /organization/positions/create              - ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÉ‡∏´‡∏°‡πà
PUT    /organization/positions/:id                 - ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á
DELETE /organization/positions/:id                 - ‡∏•‡∏ö‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á
```

---

## üîß 8. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠ (Helper Functions)

### JavaScript (Client-side)
```javascript
// Cascade load organization units
async function loadOfficesByBranch(branchId) {
    const response = await fetch(`/organization/api/units/${branchId}/children`);
    const data = await response.json();
    // Populate office dropdown
}

// Load positions by unit
async function loadPositionsByUnit(unitId) {
    const response = await fetch(`/organization/positions/api/list?unit_id=${unitId}`);
    const data = await response.json();
    // Populate position dropdown
}
```

### SQL Server (Stored Procedures)
```sql
-- ‡∏≠‡∏≤‡∏à‡∏™‡∏£‡πâ‡∏≤‡∏á SP ‡πÄ‡∏û‡∏∑‡πà‡∏≠ validate hierarchy
CREATE PROCEDURE ValidateUnitHierarchy
    @unitId INT,
    @parentId INT,
    @levelId INT
AS
BEGIN
    -- Check if parent level is correct
    -- Return success or error
END
```
