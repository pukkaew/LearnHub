<%- include('../layouts/header') %>

<div class="bg-gradient-to-br from-ruxchai-main/5 to-ruxchai-secondary/5 min-h-screen">
    <div class="container mx-auto px-6 py-8">
        <!-- Header Section -->
        <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-8">
            <div class="mb-4 md:mb-0">
                <h1 class="text-3xl font-bold text-gray-900 mb-2">Knowledge Sharing Hub</h1>
                <p class="text-gray-600">ศูนย์รวมความรู้และประสบการณ์จากผู้เชี่ยวชาญ</p>
            </div>
            <button id="createArticleBtn" class="bg-ruxchai-main text-white px-6 py-3 rounded-lg hover:bg-ruxchai-main/90 transition-colors shadow-md">
                <i class="fas fa-plus mr-2"></i>เขียนบทความใหม่
            </button>
        </div>

        <!-- Stats Cards -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
            <div class="bg-white rounded-xl p-6 shadow-sm border border-gray-100">
                <div class="flex items-center">
                    <div class="bg-blue-100 p-3 rounded-lg">
                        <i class="fas fa-newspaper text-blue-600 text-xl"></i>
                    </div>
                    <div class="ml-4">
                        <h3 class="text-sm font-medium text-gray-500">บทความทั้งหมด</h3>
                        <p id="totalArticles" class="text-2xl font-bold text-gray-900">0</p>
                    </div>
                </div>
            </div>
            <div class="bg-white rounded-xl p-6 shadow-sm border border-gray-100">
                <div class="flex items-center">
                    <div class="bg-green-100 p-3 rounded-lg">
                        <i class="fas fa-eye text-green-600 text-xl"></i>
                    </div>
                    <div class="ml-4">
                        <h3 class="text-sm font-medium text-gray-500">การดูทั้งหมด</h3>
                        <p id="totalViews" class="text-2xl font-bold text-gray-900">0</p>
                    </div>
                </div>
            </div>
            <div class="bg-white rounded-xl p-6 shadow-sm border border-gray-100">
                <div class="flex items-center">
                    <div class="bg-purple-100 p-3 rounded-lg">
                        <i class="fas fa-heart text-purple-600 text-xl"></i>
                    </div>
                    <div class="ml-4">
                        <h3 class="text-sm font-medium text-gray-500">ยอดไลค์ทั้งหมด</h3>
                        <p id="totalLikes" class="text-2xl font-bold text-gray-900">0</p>
                    </div>
                </div>
            </div>
            <div class="bg-white rounded-xl p-6 shadow-sm border border-gray-100">
                <div class="flex items-center">
                    <div class="bg-orange-100 p-3 rounded-lg">
                        <i class="fas fa-comments text-orange-600 text-xl"></i>
                    </div>
                    <div class="ml-4">
                        <h3 class="text-sm font-medium text-gray-500">ความคิดเห็น</h3>
                        <p id="totalComments" class="text-2xl font-bold text-gray-900">0</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Filters and Search -->
        <div class="bg-white rounded-xl shadow-sm border border-gray-100 p-6 mb-8">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                <div class="relative">
                    <i class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                    <input type="text" id="searchArticles" placeholder="ค้นหาบทความ..."
                           class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ruxchai-main focus:border-transparent">
                </div>
                <select id="categoryFilter" class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ruxchai-main focus:border-transparent">
                    <option value="">หมวดหมู่ทั้งหมด</option>
                    <option value="technology">เทคโนโลยี</option>
                    <option value="business">ธุรกิจ</option>
                    <option value="management">การจัดการ</option>
                    <option value="development">การพัฒนา</option>
                    <option value="design">ดีไซน์</option>
                    <option value="marketing">การตลาด</option>
                    <option value="finance">การเงิน</option>
                    <option value="other">อื่นๆ</option>
                </select>
                <select id="sortBy" class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ruxchai-main focus:border-transparent">
                    <option value="latest">ล่าสุด</option>
                    <option value="popular">ยอดนิยม</option>
                    <option value="most_viewed">ดูมากที่สุด</option>
                    <option value="most_liked">ไลค์มากที่สุด</option>
                    <option value="oldest">เก่าที่สุด</option>
                </select>
                <select id="statusFilter" class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ruxchai-main focus:border-transparent">
                    <option value="">สถานะทั้งหมด</option>
                    <option value="published">เผยแพร่แล้ว</option>
                    <option value="draft">ร่าง</option>
                    <option value="pending">รอการอนุมัติ</option>
                </select>
            </div>
        </div>

        <!-- View Toggle -->
        <div class="flex justify-between items-center mb-6">
            <div class="flex space-x-2">
                <button id="gridViewBtn" class="view-toggle-btn active px-4 py-2 rounded-lg transition-colors">
                    <i class="fas fa-th mr-2"></i>มุมมอง Grid
                </button>
                <button id="listViewBtn" class="view-toggle-btn px-4 py-2 rounded-lg transition-colors">
                    <i class="fas fa-list mr-2"></i>มุมมอง List
                </button>
            </div>
            <div class="text-sm text-gray-500">
                แสดง <span id="articlesCount">0</span> บทความ
            </div>
        </div>

        <!-- Articles Grid/List -->
        <div id="articlesContainer" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
            <!-- Articles will be loaded here -->
        </div>

        <!-- Pagination -->
        <div id="pagination" class="flex justify-center space-x-2">
            <!-- Pagination will be loaded here -->
        </div>
    </div>
</div>

<!-- Create Article Modal -->
<div id="createArticleModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
    <div class="flex items-center justify-center min-h-screen p-4">
        <div class="bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto">
            <div class="flex justify-between items-center p-6 border-b">
                <h3 class="text-xl font-bold text-gray-900">เขียนบทความใหม่</h3>
                <button id="closeCreateModal" class="text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <form id="createArticleForm" class="p-6 space-y-6">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">หัวข้อบทความ *</label>
                    <input type="text" name="title" required
                           class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ruxchai-main focus:border-transparent">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">หมวดหมู่ *</label>
                    <select name="category" required
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ruxchai-main focus:border-transparent">
                        <option value="">เลือกหมวดหมู่</option>
                        <option value="technology">เทคโนโลยี</option>
                        <option value="business">ธุรกิจ</option>
                        <option value="management">การจัดการ</option>
                        <option value="development">การพัฒนา</option>
                        <option value="design">ดีไซน์</option>
                        <option value="marketing">การตลาด</option>
                        <option value="finance">การเงิน</option>
                        <option value="other">อื่นๆ</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">สรุปเนื้อหา</label>
                    <textarea name="summary" rows="3"
                              class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ruxchai-main focus:border-transparent"
                              placeholder="สรุปสั้นๆ ของบทความ..."></textarea>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">เนื้อหาบทความ *</label>
                    <div id="articleEditor" class="border border-gray-300 rounded-lg" style="height: 300px;"></div>
                    <input type="hidden" name="content" id="articleContent">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">แท็ก</label>
                    <input type="text" name="tags"
                           class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ruxchai-main focus:border-transparent"
                           placeholder="แยกแท็กด้วยเครื่องหมายจุลภาค เช่น javascript, programming, tutorial">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">รูปปก</label>
                    <input type="file" name="featured_image" accept="image/*"
                           class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ruxchai-main focus:border-transparent">
                </div>
                <div class="flex justify-between items-center pt-4 border-t">
                    <div class="flex space-x-4">
                        <label class="flex items-center">
                            <input type="radio" name="status" value="draft" checked class="mr-2">
                            <span class="text-sm text-gray-700">บันทึกเป็นร่าง</span>
                        </label>
                        <label class="flex items-center">
                            <input type="radio" name="status" value="published" class="mr-2">
                            <span class="text-sm text-gray-700">เผยแพร่ทันที</span>
                        </label>
                    </div>
                    <div class="flex space-x-3">
                        <button type="button" id="cancelCreate" class="px-6 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50">
                            ยกเลิก
                        </button>
                        <button type="submit" class="px-6 py-2 bg-ruxchai-main text-white rounded-lg hover:bg-ruxchai-main/90">
                            บันทึกบทความ
                        </button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>

<script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>
<link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">

<script>
// Initialize Quill editor
let quill;
document.addEventListener('DOMContentLoaded', function() {
    quill = new Quill('#articleEditor', {
        theme: 'snow',
        modules: {
            toolbar: [
                [{ 'header': [1, 2, 3, false] }],
                ['bold', 'italic', 'underline', 'strike'],
                ['blockquote', 'code-block'],
                [{ 'list': 'ordered'}, { 'list': 'bullet' }],
                [{ 'script': 'sub'}, { 'script': 'super' }],
                [{ 'indent': '-1'}, { 'indent': '+1' }],
                ['link', 'image'],
                ['clean']
            ]
        }
    });
});

// Global variables
let currentPage = 1;
let currentView = 'grid';
let articles = [];

// Initialize page
document.addEventListener('DOMContentLoaded', function() {
    loadArticles();
    setupEventListeners();
});

// Event listeners
function setupEventListeners() {
    // Create article modal
    document.getElementById('createArticleBtn').addEventListener('click', () => {
        document.getElementById('createArticleModal').classList.remove('hidden');
    });

    document.getElementById('closeCreateModal').addEventListener('click', closeCreateModal);
    document.getElementById('cancelCreate').addEventListener('click', closeCreateModal);

    // Form submission
    document.getElementById('createArticleForm').addEventListener('submit', handleCreateArticle);

    // Search and filters
    document.getElementById('searchArticles').addEventListener('input', debounce(loadArticles, 300));
    document.getElementById('categoryFilter').addEventListener('change', loadArticles);
    document.getElementById('sortBy').addEventListener('change', loadArticles);
    document.getElementById('statusFilter').addEventListener('change', loadArticles);

    // View toggle
    document.getElementById('gridViewBtn').addEventListener('click', () => switchView('grid'));
    document.getElementById('listViewBtn').addEventListener('click', () => switchView('list'));
}

// Load articles
async function loadArticles() {
    try {
        const search = document.getElementById('searchArticles').value;
        const category = document.getElementById('categoryFilter').value;
        const sort = document.getElementById('sortBy').value;
        const status = document.getElementById('statusFilter').value;

        const params = new URLSearchParams({
            page: currentPage,
            search,
            category,
            sort,
            status
        });

        const response = await fetch(`/articles/api/list?${params}`);
        const data = await response.json();

        if (data.success) {
            articles = data.articles;
            displayArticles();
            updateStats(data.stats);
            updatePagination(data.pagination);
            document.getElementById('articlesCount').textContent = data.pagination.total;
        }
    } catch (error) {
        console.error('Error loading articles:', error);
        showMessage('เกิดข้อผิดพลาดในการโหลดข้อมูล', 'error');
    }
}

// Display articles
function displayArticles() {
    const container = document.getElementById('articlesContainer');

    if (currentView === 'grid') {
        container.className = 'grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8';
        container.innerHTML = articles.map(article => createArticleCard(article)).join('');
    } else {
        container.className = 'space-y-4 mb-8';
        container.innerHTML = articles.map(article => createArticleListItem(article)).join('');
    }
}

// Create article card for grid view
function createArticleCard(article) {
    const statusBadge = getStatusBadge(article.status);
    const categoryBadge = getCategoryBadge(article.category);

    return `
        <div class="bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden hover:shadow-md transition-shadow group">
            <div class="relative">
                <img src="${article.featured_image || '/images/default-article.jpg'}"
                     alt="${article.title}" class="w-full h-48 object-cover">
                <div class="absolute top-4 left-4">
                    ${statusBadge}
                </div>
                <div class="absolute top-4 right-4">
                    ${categoryBadge}
                </div>
            </div>
            <div class="p-6">
                <h3 class="font-bold text-gray-900 mb-2 group-hover:text-ruxchai-main transition-colors line-clamp-2">
                    <a href="/articles/${article.article_id}">${article.title}</a>
                </h3>
                <p class="text-gray-600 text-sm mb-4 line-clamp-3">${article.summary || ''}</p>

                <div class="flex items-center justify-between text-sm text-gray-500 mb-4">
                    <div class="flex items-center space-x-4">
                        <span><i class="fas fa-eye mr-1"></i>${article.views || 0}</span>
                        <span><i class="fas fa-heart mr-1"></i>${article.likes || 0}</span>
                        <span><i class="fas fa-comment mr-1"></i>${article.comments || 0}</span>
                    </div>
                </div>

                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-2">
                        <img src="${article.author_avatar || '/images/default-avatar.png'}"
                             alt="${article.author_name}" class="w-8 h-8 rounded-full">
                        <div>
                            <p class="text-sm font-medium text-gray-900">${article.author_name}</p>
                            <p class="text-xs text-gray-500">${formatDate(article.created_at)}</p>
                        </div>
                    </div>
                    <div class="flex space-x-2">
                        ${article.can_edit ? `
                            <button onclick="editArticle(${article.article_id})"
                                    class="text-blue-600 hover:text-blue-800 p-1">
                                <i class="fas fa-edit"></i>
                            </button>
                        ` : ''}
                        ${article.can_delete ? `
                            <button onclick="deleteArticle(${article.article_id})"
                                    class="text-red-600 hover:text-red-800 p-1">
                                <i class="fas fa-trash"></i>
                            </button>
                        ` : ''}
                    </div>
                </div>
            </div>
        </div>
    `;
}

// Create article list item for list view
function createArticleListItem(article) {
    const statusBadge = getStatusBadge(article.status);
    const categoryBadge = getCategoryBadge(article.category);

    return `
        <div class="bg-white rounded-xl shadow-sm border border-gray-100 p-6 hover:shadow-md transition-shadow">
            <div class="flex flex-col md:flex-row md:items-center space-y-4 md:space-y-0 md:space-x-6">
                <div class="md:w-48 flex-shrink-0">
                    <img src="${article.featured_image || '/images/default-article.jpg'}"
                         alt="${article.title}" class="w-full h-32 object-cover rounded-lg">
                </div>
                <div class="flex-1">
                    <div class="flex items-start justify-between mb-2">
                        <h3 class="font-bold text-xl text-gray-900 hover:text-ruxchai-main transition-colors">
                            <a href="/articles/${article.article_id}">${article.title}</a>
                        </h3>
                        <div class="flex space-x-2 ml-4">
                            ${statusBadge}
                            ${categoryBadge}
                        </div>
                    </div>

                    <p class="text-gray-600 mb-4 line-clamp-2">${article.summary || ''}</p>

                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-2">
                            <img src="${article.author_avatar || '/images/default-avatar.png'}"
                                 alt="${article.author_name}" class="w-8 h-8 rounded-full">
                            <div>
                                <p class="text-sm font-medium text-gray-900">${article.author_name}</p>
                                <p class="text-xs text-gray-500">${formatDate(article.created_at)}</p>
                            </div>
                        </div>

                        <div class="flex items-center space-x-6 text-sm text-gray-500">
                            <span><i class="fas fa-eye mr-1"></i>${article.views || 0}</span>
                            <span><i class="fas fa-heart mr-1"></i>${article.likes || 0}</span>
                            <span><i class="fas fa-comment mr-1"></i>${article.comments || 0}</span>

                            ${article.can_edit || article.can_delete ? `
                                <div class="flex space-x-2 ml-4">
                                    ${article.can_edit ? `
                                        <button onclick="editArticle(${article.article_id})"
                                                class="text-blue-600 hover:text-blue-800 p-1">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                    ` : ''}
                                    ${article.can_delete ? `
                                        <button onclick="deleteArticle(${article.article_id})"
                                                class="text-red-600 hover:text-red-800 p-1">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    ` : ''}
                                </div>
                            ` : ''}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    `;
}

// Status badge
function getStatusBadge(status) {
    const badges = {
        published: '<span class="px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full">เผยแพร่แล้ว</span>',
        draft: '<span class="px-2 py-1 bg-gray-100 text-gray-800 text-xs rounded-full">ร่าง</span>',
        pending: '<span class="px-2 py-1 bg-yellow-100 text-yellow-800 text-xs rounded-full">รอการอนุมัติ</span>'
    };
    return badges[status] || '';
}

// Category badge
function getCategoryBadge(category) {
    const badges = {
        technology: '<span class="px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full">เทคโนโลยี</span>',
        business: '<span class="px-2 py-1 bg-purple-100 text-purple-800 text-xs rounded-full">ธุรกิจ</span>',
        management: '<span class="px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full">การจัดการ</span>',
        development: '<span class="px-2 py-1 bg-orange-100 text-orange-800 text-xs rounded-full">การพัฒนา</span>',
        design: '<span class="px-2 py-1 bg-pink-100 text-pink-800 text-xs rounded-full">ดีไซน์</span>',
        marketing: '<span class="px-2 py-1 bg-red-100 text-red-800 text-xs rounded-full">การตลาด</span>',
        finance: '<span class="px-2 py-1 bg-yellow-100 text-yellow-800 text-xs rounded-full">การเงิน</span>',
        other: '<span class="px-2 py-1 bg-gray-100 text-gray-800 text-xs rounded-full">อื่นๆ</span>'
    };
    return badges[category] || '';
}

// Switch view
function switchView(view) {
    currentView = view;

    document.querySelectorAll('.view-toggle-btn').forEach(btn => {
        btn.classList.remove('active');
    });

    if (view === 'grid') {
        document.getElementById('gridViewBtn').classList.add('active');
    } else {
        document.getElementById('listViewBtn').classList.add('active');
    }

    displayArticles();
}

// Handle create article
async function handleCreateArticle(e) {
    e.preventDefault();

    try {
        const formData = new FormData(e.target);
        formData.set('content', quill.root.innerHTML);

        const response = await fetch('/articles/create', {
            method: 'POST',
            body: formData
        });

        const data = await response.json();

        if (data.success) {
            showMessage('บันทึกบทความเรียบร้อยแล้ว', 'success');
            closeCreateModal();
            loadArticles();
        } else {
            showMessage(data.message || 'เกิดข้อผิดพลาด', 'error');
        }
    } catch (error) {
        console.error('Error creating article:', error);
        showMessage('เกิดข้อผิดพลาดในการบันทึก', 'error');
    }
}

// Close create modal
function closeCreateModal() {
    document.getElementById('createArticleModal').classList.add('hidden');
    document.getElementById('createArticleForm').reset();
    if (quill) {
        quill.setContents([]);
    }
}

// Edit article
function editArticle(articleId) {
    window.location.href = `/articles/${articleId}/edit`;
}

// Delete article
async function deleteArticle(articleId) {
    if (!confirm('คุณแน่ใจหรือไม่ที่จะลบบทความนี้?')) return;

    try {
        const response = await fetch(`/articles/${articleId}`, {
            method: 'DELETE'
        });

        const data = await response.json();

        if (data.success) {
            showMessage('ลบบทความเรียบร้อยแล้ว', 'success');
            loadArticles();
        } else {
            showMessage(data.message || 'เกิดข้อผิดพลาด', 'error');
        }
    } catch (error) {
        console.error('Error deleting article:', error);
        showMessage('เกิดข้อผิดพลาดในการลบ', 'error');
    }
}

// Update stats
function updateStats(stats) {
    document.getElementById('totalArticles').textContent = stats.total_articles || 0;
    document.getElementById('totalViews').textContent = stats.total_views || 0;
    document.getElementById('totalLikes').textContent = stats.total_likes || 0;
    document.getElementById('totalComments').textContent = stats.total_comments || 0;
}

// Update pagination
function updatePagination(pagination) {
    const container = document.getElementById('pagination');
    container.innerHTML = '';

    if (pagination.total_pages <= 1) return;

    // Previous button
    if (pagination.current_page > 1) {
        const prevBtn = document.createElement('button');
        prevBtn.className = 'px-3 py-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg';
        prevBtn.innerHTML = '<i class="fas fa-chevron-left"></i>';
        prevBtn.onclick = () => goToPage(pagination.current_page - 1);
        container.appendChild(prevBtn);
    }

    // Page numbers
    for (let i = Math.max(1, pagination.current_page - 2);
         i <= Math.min(pagination.total_pages, pagination.current_page + 2); i++) {
        const pageBtn = document.createElement('button');
        pageBtn.className = i === pagination.current_page
            ? 'px-3 py-2 bg-ruxchai-main text-white rounded-lg'
            : 'px-3 py-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg';
        pageBtn.textContent = i;
        pageBtn.onclick = () => goToPage(i);
        container.appendChild(pageBtn);
    }

    // Next button
    if (pagination.current_page < pagination.total_pages) {
        const nextBtn = document.createElement('button');
        nextBtn.className = 'px-3 py-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg';
        nextBtn.innerHTML = '<i class="fas fa-chevron-right"></i>';
        nextBtn.onclick = () => goToPage(pagination.current_page + 1);
        container.appendChild(nextBtn);
    }
}

// Go to page
function goToPage(page) {
    currentPage = page;
    loadArticles();
}

// Utility functions
function formatDate(dateString) {
    const options = {
        year: 'numeric',
        month: 'short',
        day: 'numeric',
        hour: '2-digit',
        minute: '2-digit'
    };
    return new Date(dateString).toLocaleDateString('th-TH', options);
}

function debounce(func, wait) {
    let timeout;
    return function executedFunction(...args) {
        const later = () => {
            clearTimeout(timeout);
            func(...args);
        };
        clearTimeout(timeout);
        timeout = setTimeout(later, wait);
    };
}

function showMessage(message, type = 'info') {
    // Create and show message notification
    const messageDiv = document.createElement('div');
    messageDiv.className = `fixed top-4 right-4 z-50 px-6 py-3 rounded-lg text-white ${
        type === 'success' ? 'bg-green-500' : type === 'error' ? 'bg-red-500' : 'bg-blue-500'
    }`;
    messageDiv.textContent = message;

    document.body.appendChild(messageDiv);

    setTimeout(() => {
        messageDiv.remove();
    }, 3000);
}

// Add CSS for view toggle buttons
const style = document.createElement('style');
style.textContent = `
    .view-toggle-btn {
        background-color: #f3f4f6;
        color: #6b7280;
    }
    .view-toggle-btn.active {
        background-color: var(--ruxchai-main);
        color: white;
    }
    .line-clamp-2 {
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
    }
    .line-clamp-3 {
        display: -webkit-box;
        -webkit-line-clamp: 3;
        -webkit-box-orient: vertical;
        overflow: hidden;
    }
`;
document.head.appendChild(style);
</script>

<%- include('../layouts/footer') %>